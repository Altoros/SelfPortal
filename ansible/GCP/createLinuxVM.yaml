- hosts: localhost
  connection: local
  tasks:
    - gce:
        service_account_email: "{{ GCP_SERVICE_ACCOUNT }}"
        credentials_file: "{{ GCP_CREDENTIALS_FILE }}"
        instance_names: "{{ VM_NAME }}"
        zone: "{{ DEFAULT_ZONE }}"
        machine_type: "{{ DEFAULT_VM_SIZE }}"
        image: "{{ TEMPLATE_NAME }}"
        state: present
        project_id: "{{ GCP_PROJECT_ID }}"
        disk_size: "{{ DEFAULT_DISK_SIZE }}"
        metadata : '{ "startup-script" : "echo adding_user...;useradd selfportal; mkdir -p /home/selfportal/.ssh; touch /home/selfportal/.ssh; echo {{ SSH_KEY }} >> /home/selfportal/.ssh/authorized_keys; chown selfportal:selfportal /home/selfportal -R;", "description" : "{{ VM_DESCRIPTION }}" }'